<!DOCTYPE html>
<html lang="fr">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0"/>
  <title>Journal de Trading - EOC Pro</title>
  <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700&display=swap" rel="stylesheet">
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0-beta3/css/all.min.css">
  <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
  <style>
    :root {
      --primary-color: #4361ee;
      --primary-light: #3a86ff;
      --secondary-color: #4895ef;
      --accent-color: #4cc9f0;
      --win-color: #4ade80;
      --loss-color: #f87171;
      --text-light: #f8f9fa;
      --text-dark: #212529;
      --bg-dark: #1e293b;
      --bg-darker: #0f172a;
      --card-bg: rgba(30, 41, 59, 0.8);
      --border-color: rgba(255, 255, 255, 0.1);
      --light-bg: #f8f9fa;
      --light-text: #212529;
      --light-card: #ffffff;
      --light-border: #e9ecef;
    }

    body.light-mode {
      background: var(--light-bg);
      color: var(--light-text);
      --card-bg: var(--light-card);
      --border-color: var(--light-border);
      --bg-dark: var(--light-bg);
      --bg-darker: #e9ecef;
    }

    body.light-mode nav {
      background-color: var(--light-card);
      border-bottom: 1px solid var(--light-border);
    }

    body.light-mode .nav-brand {
      color: var(--light-text);
    }

    body.light-mode .nav-menu a {
      color: var(--light-text);
    }

    body.light-mode input,
    body.light-mode select,
    body.light-mode textarea {
      background-color: white;
      color: var(--light-text);
      border-color: var(--light-border);
    }

    body.light-mode .stat-card {
      color: white;
    }

    * {
      box-sizing: border-box;
      margin: 0;
      padding: 0;
    }
    
    body {
      font-family: 'Inter', sans-serif;
      margin: 0;
      padding: 0;
      background: linear-gradient(135deg, var(--bg-darker) 0%, var(--bg-dark) 100%);
      color: var(--text-light);
      line-height: 1.6;
      min-height: 100vh;
      transition: background 0.3s ease, color 0.3s ease;
    }
    
    #splash {
      position: fixed;
      top: 0;
      left: 0;
      width: 100%;
      height: 100%;
      background-color: #0a1930;
      color: white;
      display: flex;
      flex-direction: column;
      justify-content: center;
      align-items: center;
      z-index: 9999;
      text-align: center;
    }
    
    #splash h1 {
      font-size: 4rem;
      margin-bottom: 20px;
      animation: fadeIn 2s ease;
    }
    
    #splash p {
      font-size: 1.25rem;
      opacity: 0.8;
    }
    
    #enterBtn {
      margin-top: 40px;
      padding: 12px 25px;
      font-size: 1rem;
      background-color: #4cc9f0;
      color: white;
      border: none;
      border-radius: 8px;
      cursor: pointer;
      opacity: 0;
      transition: opacity 1s ease;
    }
    
    #enterBtn.show {
      opacity: 1;
    }
    
    @keyframes fadeIn {
      from { opacity: 0; transform: scale(0.95); }
      to { opacity: 1; transform: scale(1); }
    }
    
    nav {
      background-color: var(--bg-darker);
      padding: 1rem 0;
      box-shadow: 0 4px 6px -1px rgba(0, 0, 0, 0.1), 0 2px 4px -1px rgba(0, 0, 0, 0.06);
      position: sticky;
      top: 0;
      z-index: 100;
      backdrop-filter: blur(8px);
      border-bottom: 1px solid var(--border-color);
    }
    
    .nav-container {
      display: flex;
      justify-content: space-between;
      align-items: center;
      max-width: 1200px;
      margin: 0 auto;
      padding: 0 2rem;
    }
    
    .nav-brand {
      display: flex;
      align-items: center;
      gap: 0.75rem;
      font-weight: 700;
      font-size: 1.25rem;
      color: var(--text-light);
      text-decoration: none;
    }
    
    .nav-brand i {
      color: var(--primary-light);
    }
    
    .nav-menu {
      display: flex;
      list-style: none;
      margin: 0;
      padding: 0;
      gap: 1rem;
      align-items: center;
    }
    
    .nav-menu a {
      color: var(--text-light);
      text-decoration: none;
      font-weight: 500;
      font-size: 0.95rem;
      padding: 0.5rem 1rem;
      border-radius: 0.5rem;
      transition: all 0.2s ease-in-out;
      display: flex;
      align-items: center;
      gap: 0.5rem;
    }
    
    .nav-menu a:hover, .nav-menu a.active {
      background-color: rgba(67, 97, 238, 0.2);
      color: var(--primary-light);
    }
    
    .nav-menu a.active {
      background-color: var(--primary-color);
      color: white;
    }
    
    .menu-button {
      display: none;
      background: none;
      border: none;
      color: var(--text-light);
      font-size: 1.5rem;
      cursor: pointer;
    }
    
    .dropdown-menu {
      position: absolute;
      right: 2rem;
      top: 4rem;
      background-color: var(--bg-darker);
      border-radius: 0.5rem;
      box-shadow: 0 10px 15px -3px rgba(0, 0, 0, 0.1), 0 4px 6px -2px rgba(0, 0, 0, 0.05);
      padding: 0.5rem;
      min-width: 200px;
      border: 1px solid var(--border-color);
      display: none;
      z-index: 1000;
    }
    
    .dropdown-menu.show {
      display: block;
    }
    
    .dropdown-menu a {
      display: block;
      padding: 0.75rem 1rem;
      color: var(--text-light);
      text-decoration: none;
      border-radius: 0.25rem;
      transition: background-color 0.2s;
    }
    
    .dropdown-menu a:hover {
      background-color: rgba(67, 97, 238, 0.2);
    }
    
    .container {
      max-width: 1200px;
      margin: 2rem auto;
      padding: 0 2rem;
    }
    
    .page-header {
      display: flex;
      justify-content: space-between;
      align-items: center;
      margin-bottom: 2rem;
    }
    
    h1 {
      font-size: 2rem;
      margin-bottom: 1.5rem;
      background: linear-gradient(90deg, var(--primary-light), var(--accent-color));
      -webkit-background-clip: text;
      -webkit-text-fill-color: transparent;
      display: inline-block;
      animation: fadeInScale 1s ease-in-out;
    }
    
    @keyframes fadeInScale {
      0% { opacity: 0; transform: scale(0.95); }
      100% { opacity: 1; transform: scale(1); }
    }
    
    .section {
      display: none;
      animation: fadeIn 0.5s ease-out;
    }
    
    .section.active {
      display: block;
    }
    
    @keyframes fadeIn {
      from { opacity: 0; transform: translateY(10px); }
      to { opacity: 1; transform: translateY(0); }
    }
    
    .stat-card {
      padding: 1.5rem;
      border-radius: 0.75rem;
      text-align: center;
      transition: all 0.3s ease;
      box-shadow: 0 4px 6px rgba(0, 0, 0, 0.1);
      border: 1px solid var(--border-color);
    }
    
    .stat-card.gradient-blue {
      background: linear-gradient(135deg, #4361ee 0%, #3a86ff 100%);
      color: white;
    }
    
    .stat-card.gradient-teal {
      background: linear-gradient(135deg, #4895ef 0%, #4cc9f0 100%);
      color: white;
    }
    
    .stat-card.gradient-aqua {
      background: linear-gradient(135deg, #4cc9f0 0%, #4895ef 100%);
      color: white;
    }
    
    .stat-card.gradient-darkblue {
      background: linear-gradient(135deg, #3a86ff 0%, #4361ee 100%);
      color: white;
    }
    
    .stat-card h3 {
      font-size: 0.9rem;
      margin-bottom: 0.5rem;
      text-transform: uppercase;
      letter-spacing: 1px;
    }
    
    .stat-card .value {
      font-size: 1.8rem;
      font-weight: 700;
      margin: 0.5rem 0;
    }
    
    .stats-grid {
      display: grid;
      gap: 1rem;
      margin: 1rem 0 2rem;
    }
    
    table {
      width: 100%;
      border-collapse: collapse;
      margin: 1rem 0;
      background-color: var(--card-bg);
      border-radius: 0.75rem;
      overflow: hidden;
      box-shadow: 0 4px 6px rgba(0, 0, 0, 0.1);
    }
    
    th, td {
      padding: 0.75rem;
      text-align: center;
      border-bottom: 1px solid var(--border-color);
    }
    
    th {
      background-color: var(--bg-darker);
      font-weight: 600;
      color: var(--primary-light);
      text-transform: uppercase;
      font-size: 0.8rem;
    }
    
    tr:hover {
      background-color: rgba(67, 97, 238, 0.1);
    }
    
    .chart-container {
      display: grid;
      gap: 1.5rem;
      margin: 2rem 0;
    }
    
    .chart-wrapper {
      background-color: var(--card-bg);
      border-radius: 0.75rem;
      padding: 1.5rem;
      box-shadow: 0 4px 6px rgba(0, 0, 0, 0.1);
      border: 1px solid var(--border-color);
    }
    
    .chart-wrapper h2 {
      margin-top: 0;
      margin-bottom: 1.5rem;
      font-size: 1.25rem;
      display: flex;
      align-items: center;
      gap: 0.5rem;
    }
    
    .filter-container {
      display: flex;
      flex-wrap: wrap;
      gap: 1rem;
      margin: 1.5rem 0;
      align-items: center;
      background-color: var(--card-bg);
      padding: 1.25rem;
      border-radius: 0.75rem;
      box-shadow: 0 4px 6px -1px rgba(0, 0, 0, 0.1), 0 2px 4px -1px rgba(0, 0, 0, 0.06);
      border: 1px solid var(--border-color);
    }
    
    .filter-group {
      display: flex;
      align-items: center;
      gap: 0.75rem;
    }
    
    .filter-group label {
      font-weight: 500;
      font-size: 0.9rem;
      white-space: nowrap;
    }
    
    input, select, textarea {
      border: 1px solid var(--border-color);
      border-radius: 0.5rem;
      padding: 0.65rem 0.75rem;
      background-color: var(--bg-darker);
      font-family: 'Inter', sans-serif;
      color: var(--text-light);
      font-size: 0.9rem;
      transition: all 0.2s ease-in-out;
    }
    
    input:focus, select:focus, textarea:focus {
      outline: none;
      border-color: var(--primary-light);
      box-shadow: 0 0 0 2px rgba(67, 97, 238, 0.2);
    }
    
    .button-group {
      display: flex;
      flex-wrap: wrap;
      gap: 0.75rem;
      margin: 1.5rem 0;
    }
    
    button {
      padding: 0.75rem 1.25rem;
      background-color: var(--primary-color);
      border: none;
      color: white;
      cursor: pointer;
      border-radius: 0.5rem;
      font-family: 'Inter', sans-serif;
      font-weight: 500;
      transition: all 0.2s ease-in-out;
      display: flex;
      align-items: center;
      gap: 0.5rem;
      font-size: 0.9rem;
      box-shadow: 0 1px 2px 0 rgba(0, 0, 0, 0.05);
    }
    
    button:hover {
      background-color: var(--primary-light);
      transform: translateY(-2px);
      box-shadow: 0 4px 6px -1px rgba(0, 0, 0, 0.1), 0 2px 4px -1px rgba(0, 0, 0, 0.06);
    }
    
    button.secondary {
      background-color: transparent;
      border: 1px solid var(--border-color);
      color: var(--text-light);
    }
    
    button.secondary:hover {
      background-color: rgba(255, 255, 255, 0.05);
      border-color: var(--primary-light);
    }
    
    button i {
      font-size: 1rem;
    }
    
    .conseil-card {
      background-color: var(--card-bg);
      padding: 1rem;
      border-radius: 0.5rem;
      margin: 1.5rem 0;
      border-left: 4px solid var(--primary-color);
      font-style: italic;
      display: flex;
      align-items: center;
      gap: 0.75rem;
    }
    
    .brokers-container {
      display: grid;
      grid-template-columns: repeat(auto-fill, minmax(300px, 1fr));
      gap: 1.5rem;
      margin: 2rem 0;
    }
    
    .broker-card {
      background-color: var(--card-bg);
      border-radius: 0.75rem;
      padding: 1.5rem;
      box-shadow: 0 4px 6px -1px rgba(0, 0, 0, 0.1), 0 2px 4px -1px rgba(0, 0, 0, 0.06);
      border: 1px solid var(--border-color);
      transition: all 0.3s ease;
    }
    
    .broker-card:hover {
      transform: translateY(-5px);
      box-shadow: 0 10px 15px -3px rgba(0, 0, 0, 0.1), 0 4px 6px -2px rgba(0, 0, 0, 0.05);
    }
    
    .broker-card h3 {
      margin-top: 0;
      color: var(--primary-light);
      display: flex;
      align-items: center;
      gap: 0.5rem;
    }
    
    .broker-card p {
      margin-bottom: 1.5rem;
      color: rgba(255, 255, 255, 0.7);
    }
    
    .broker-card a {
      display: inline-block;
      padding: 0.5rem 1rem;
      background-color: var(--primary-color);
      color: white;
      text-decoration: none;
      border-radius: 0.5rem;
      font-weight: 500;
      transition: all 0.2s;
    }
    
    .broker-card a:hover {
      background-color: var(--primary-light);
    }
    
    .calendar-container {
      background-color: var(--card-bg);
      border-radius: 0.75rem;
      padding: 1.5rem;
      box-shadow: 0 4px 6px -1px rgba(0, 0, 0, 0.1), 0 2px 4px -1px rgba(0, 0, 0, 0.06);
      border: 1px solid var(--border-color);
    }
    
    .economic-calendar {
      width: 100%;
      height: 600px;
      border: none;
      border-radius: 0.5rem;
    }
    
    .settings-option {
      margin-bottom: 1.5rem;
    }
    
    .settings-option h3 {
      margin-bottom: 0.75rem;
      font-size: 1.1rem;
      display: flex;
      align-items: center;
      gap: 0.5rem;
    }
    
    .settings-option .option-group {
      display: flex;
      gap: 1rem;
      flex-wrap: wrap;
    }
    
    .settings-option .option-item {
      display: flex;
      align-items: center;
      gap: 0.5rem;
      padding: 0.5rem 1rem;
      border-radius: 0.5rem;
      background-color: var(--bg-darker);
      border: 1px solid var(--border-color);
      cursor: pointer;
      transition: all 0.2s;
    }
    
    .settings-option .option-item:hover {
      background-color: rgba(67, 97, 238, 0.2);
      border-color: var(--primary-light);
    }
    
    .settings-option .option-item.active {
      background-color: var(--primary-color);
      color: white;
      border-color: var(--primary-color);
    }
    
    @media (max-width: 768px) {
      .nav-container {
        flex-direction: column;
        gap: 1rem;
      }
      
      .nav-menu {
        width: 100%;
        overflow-x: auto;
        padding-bottom: 0.5rem;
      }
      
      .menu-button {
        display: block;
      }
      
      .nav-menu.hidden {
        display: none;
      }
      
      .filter-container {
        flex-direction: column;
        align-items: flex-start;
      }
      
      .filter-group {
        width: 100%;
      }
      
      .chart-container {
        grid-template-columns: 1fr;
      }
      
      .stats-grid {
        grid-template-columns: 1fr 1fr;
      }
    }
    
    @media (max-width: 480px) {
      .container {
        padding: 0 1rem;
      }
      
      .stats-grid {
        grid-template-columns: 1fr;
      }
      
      table {
        font-size: 0.8rem;
      }
      
      th, td {
        padding: 0.5rem;
      }
    }
  </style>
</head>
<body>
  <div id="splash">
    <h1>EOC</h1>
    <p>Bienvenue dans ton Journal de Trading</p>
    <button id="enterBtn">Welcome</button>
  </div>

  <div id="mainApp" style="display: none;">
    <nav>
      <div class="nav-container">
        <a href="#" class="nav-brand">
          <i class="fas fa-chart-line"></i>
          <span>EOC Pro</span>
        </a>
        
        <button class="menu-button" onclick="toggleMenu()">
          <i class="fas fa-bars"></i>
        </button>
        
        <ul class="nav-menu">
          <li><a href="#" class="active" data-section="dashboard"><i class="fas fa-tachometer-alt"></i> <span class="nav-text">Dashboard</span></a></li>
          <li><a href="#" data-section="performance"><i class="fas fa-chart-bar"></i> <span class="nav-text">Performance</span></a></li>
          <li><a href="#" data-section="brokers"><i class="fas fa-building"></i> <span class="nav-text">Brokers</span></a></li>
          <li><a href="#" data-section="calendar"><i class="fas fa-calendar-alt"></i> <span class="nav-text">Calendar</span></a></li>
          <li><a href="#" data-section="settings"><i class="fas fa-cog"></i> <span class="nav-text">Settings</span></a></li>
        </ul>
        
        <div class="dropdown-menu" id="dropdownMenu">
          <a href="#" data-section="dashboard"><i class="fas fa-tachometer-alt"></i> <span class="nav-text">Dashboard</span></a>
          <a href="#" data-section="performance"><i class="fas fa-chart-bar"></i> <span class="nav-text">Performance</span></a>
          <a href="#" data-section="brokers"><i class="fas fa-building"></i> <span class="nav-text">Brokers</span></a>
          <a href="#" data-section="calendar"><i class="fas fa-calendar-alt"></i> <span class="nav-text">Calendar</span></a>
          <hr style="border-color: var(--border-color); margin: 0.5rem 0;">
          <a href="#" id="login-link"><i class="fas fa-sign-in-alt"></i> <span class="nav-text">Login</span></a>
          <a href="#" id="signup-link"><i class="fas fa-user-plus"></i> <span class="nav-text">Sign Up</span></a>
        </div>
      </div>
    </nav>

    <div class="container">
      <section id="dashboard-section" class="section active">
        <div class="page-header">
          <h1 id="animated-title"><i class="fas fa-tachometer-alt"></i> <span class="section-title">TABLEAU DE BORD</span></h1>
          <button onclick="addTrade()" class="secondary"><i class="fas fa-plus"></i> <span class="btn-text">Nouveau Trade</span></button>
        </div>

        <div class="conseil-card" id="conseilDuJour">
          <i class="fas fa-lightbulb"></i> Chargement du conseil...
        </div>

        <div class="stats-grid" style="grid-template-columns: repeat(4, 1fr);">
          <div class="stat-card gradient-blue">
            <h3 class="stat-title">PROFIT/PERTE</h3>
            <div class="value" id="totalGain">0%</div>
          </div>
          <div class="stat-card gradient-teal">
            <h3 class="stat-title">RISK/REWARD</h3>
            <div class="value" id="averageRRR">0</div>
          </div>
          <div class="stat-card gradient-aqua">
            <h3 class="stat-title">RATIO MOYEN</h3>
            <div class="value" id="profitFactor">0</div>
          </div>
          <div class="stat-card gradient-darkblue">
            <h3 class="stat-title">WIN RATE</h3>
            <div class="value" id="winRate">0%</div>
          </div>
        </div>

        <div class="stats-grid" style="grid-template-columns: repeat(3, 1fr);">
          <div class="stat-card">
            <h3 class="stat-title">DRAWDOWN</h3>
            <div class="value" id="drawdown">0%</div>
          </div>
          <div class="stat-card">
            <h3 class="stat-title">PERTES MAX JOURNALIERES</h3>
            <div class="value">0.00% / 1%</div>
          </div>
          <div class="stat-card">
            <h3 class="stat-title">PERTES MAX HEBDOMADAIRES</h3>
            <div class="value">0.00% / 3%</div>
          </div>
        </div>

        <div class="chart-wrapper" style="margin-bottom: 2rem;">
          <h2><i class="fas fa-calendar-alt"></i> PERFORMANCE MENSUELLE</h2>
          <div style="overflow-x: auto;">
            <table id="monthlyTable">
              <thead>
                <tr>
                  <th>Mois</th>
                  <th>Janvier</th>
                  <th>Février</th>
                  <th>Mars</th>
                  <th>Avril</th>
                  <th>Mai</th>
                  <th>Juin</th>
                  <th>Juillet</th>
                  <th>Août</th>
                  <th>Septembre</th>
                  <th>Octobre</th>
                  <th>Novembre</th>
                  <th>Décembre</th>
                  <th>Total</th>
                </tr>
              </thead>
              <tbody>
                <tr>
                  <td>2024</td>
                  <td id="jan-profit">0%</td>
                  <td id="feb-profit">0%</td>
                  <td id="mar-profit">0%</td>
                  <td id="apr-profit">0%</td>
                  <td id="may-profit">0%</td>
                  <td id="jun-profit">0%</td>
                  <td id="jul-profit">0%</td>
                  <td id="aug-profit">0%</td>
                  <td id="sep-profit">0%</td>
                  <td id="oct-profit">0%</td>
                  <td id="nov-profit">0%</td>
                  <td id="dec-profit">0%</td>
                  <td id="year-profit">0%</td>
                </tr>
                <tr>
                  <td>Risk/Reward</td>
                  <td id="jan-rr">0</td>
                  <td id="feb-rr">0</td>
                  <td id="mar-rr">0</td>
                  <td id="apr-rr">0</td>
                  <td id="may-rr">0</td>
                  <td id="jun-rr">0</td>
                  <td id="jul-rr">0</td>
                  <td id="aug-rr">0</td>
                  <td id="sep-rr">0</td>
                  <td id="oct-rr">0</td>
                  <td id="nov-rr">0</td>
                  <td id="dec-rr">0</td>
                  <td id="year-rr">0</td>
                </tr>
              </tbody>
            </table>
          </div>
        </div>

        <div class="chart-container" style="grid-template-columns: 1fr 2fr; gap: 1.5rem;">
          <div class="chart-wrapper">
            <h2><i class="fas fa-chart-line"></i> EVOLUTION DU CAPITAL</h2>
            <canvas id="capitalChart" width="400" height="500"></canvas>
          </div>
          
          <div class="chart-wrapper">
            <h2><i class="fas fa-chart-pie"></i> PERFORMANCE DES TRADES</h2>
            <canvas id="pieChart" width="400" height="400"></canvas>
          </div>
        </div>

        <div class="filter-container fade-in">
          <div class="filter-group">
            <label for="initialCapital"><i class="fas fa-wallet"></i> CAPITAL INITIAL:</label>
            <input type="number" id="initialCapital" value="1000" onchange="updateStats()" />
          </div>
          
          <div class="filter-group">
            <label for="symbolFilter"><i class="fas fa-filter"></i> SYMBOLE:</label>
            <input type="text" id="symbolFilter" placeholder="Filtrer par symbole" oninput="updateStats()">
          </div>
          
          <div class="filter-group">
            <label for="dateFromFilter"><i class="fas fa-calendar"></i> DE:</label>
            <input type="date" id="dateFromFilter" onchange="updateStats()">
          </div>
          
          <div class="filter-group">
            <label for="dateToFilter"><i class="fas fa-calendar"></i> À:</label>
            <input type="date" id="dateToFilter" onchange="updateStats()">
          </div>
          
          <button onclick="resetFilters()"><i class="fas fa-sync-alt"></i> <span class="btn-text">Reset</span></button>
        </div>

        <div class="button-group">
          <button onclick="downloadJSON()"><i class="fas fa-save"></i> <span class="btn-text">Sauvegarder</span></button>
          <button onclick="downloadCSV()"><i class="fas fa-file-csv"></i> <span class="btn-text">Exporter CSV</span></button>
          <input type="file" id="fileInput" accept="application/json" style="display: none;" />
          <button onclick="document.getElementById('fileInput').click()" class="secondary"><i class="fas fa-folder-open"></i> <span class="btn-text">Charger</span></button>
        </div>

        <div style="overflow-x: auto;">
          <table id="tradeTable">
            <thead>
              <tr>
                <th class="table-header">DATE</th>
                <th class="table-header">SYMBOLE</th>
                <th class="table-header">LOT</th>
                <th class="table-header">TYPE</th>
                <th class="table-header">ENTRÉE</th>
                <th class="table-header">SORTIE</th>
                <th class="table-header">RÉSULTAT</th>
                <th class="table-header">P/L ($)</th>
                <th class="table-header">RR</th>
                <th class="table-header">NOTES</th>
              </tr>
            </thead>
            <tbody></tbody>
          </table>
        </div>
      </section>

      <section id="performance-section" class="section">
        <div class="page-header">
          <h1><i class="fas fa-chart-bar"></i> PERFORMANCE</h1>
        </div>

        <div class="chart-container">
          <div class="chart-wrapper">
            <h2><i class="fas fa-chart-line"></i> ÉVOLUTION DU CAPITAL</h2>
            <canvas id="perf-capitalChart" width="800" height="400"></canvas>
          </div>
          
          <div class="chart-wrapper">
            <h2><i class="fas fa-chart-pie"></i> PERFORMANCE DES TRADES</h2>
            <canvas id="perf-pieChart" width="300" height="300"></canvas>
          </div>
        </div>

        <div class="chart-container">
          <div class="chart-wrapper">
            <h2><i class="fas fa-chart-bar"></i> PERFORMANCE JOURNALIÈRE</h2>
            <canvas id="perf-dailyChart" width="800" height="400"></canvas>
          </div>
        </div>
      </section>

      <section id="brokers-section" class="section">
        <div class="page-header">
          <h1><i class="fas fa-building"></i> BROKERS RECOMMANDÉS</h1>
        </div>

        <div class="brokers-container">
          <div class="broker-card">
            <h3><i class="fas fa-check-circle"></i> EXNESS</h3>
            <p>Trade with tight spreads and instant execution on one of the most trusted brokers in the industry.</p>
            <a href="https://one.exnesstrack.org/intl/fr/a/i911hyordj" target="_blank" class="broker-link">Ouvrir un compte</a>
          </div>
          
          <div class="broker-card">
            <h3><i class="fas fa-check-circle"></i> HEADWAY</h3>
            <p>Start your trading journey with Headway and enjoy competitive trading conditions.</p>
            <a href="https://headway.partners/user/signup?hwp=2107f0" target="_blank" class="broker-link">Ouvrir un compte</a>
          </div>
          
          <div class="broker-card">
            <h3><i class="fas fa-check-circle"></i> FBS</h3>
            <p>Join FBS broker and trade with leverage up to 1:3000 on various financial instruments.</p>
            <a href="https://fbs.partners?ibl=891392&ibp=25515221" target="_blank" class="broker-link">Ouvrir un compte</a>
          </div>
          
          <div class="broker-card">
            <h3><i class="fas fa-check-circle"></i> JUSTMARKETS</h3>
            <p>Broker fiable avec des conditions de trading compétitives et une plateforme facile à utiliser.</p>
            <a href="https://one.justmarkets.link/a/2oozd0s1d1" target="_blank" class="broker-link">Ouvrir un compte</a>
          </div>
          
          <div class="broker-card">
            <h3><i class="fas fa-check-circle"></i> LITE FINANCE</h3>
            <p>Broker régulé offrant des spreads serrés et une exécution rapide des ordres.</p>
            <a href="https://www.litefinance.org/?uid=114959820" target="_blank" class="broker-link">Ouvrir un compte</a>
          </div>
        </div>
      </section>

      <section id="calendar-section" class="section">
        <div class="page-header">
          <h1><i class="fas fa-calendar-alt"></i> CALENDRIER ÉCONOMIQUE</h1>
        </div>
        
        <div class="calendar-container">
          <iframe src="https://www.forexfactory.com/calendar" 
                  class="economic-calendar"
                  allowfullscreen></iframe>
        </div>
      </section>

      <section id="settings-section" class="section">
        <div class="page-header">
          <h1><i class="fas fa-cog"></i> PARAMÈTRES</h1>
        </div>

        <div class="settings-option">
          <h3><i class="fas fa-language"></i> Langue</h3>
          <div class="option-group">
            <div class="option-item active" data-lang="fr" onclick="changeLanguage('fr')">
              <i class="fas fa-check"></i> Français
            </div>
            <div class="option-item" data-lang="en" onclick="changeLanguage('en')">
              English
            </div>
          </div>
        </div>

        <div class="settings-option">
          <h3><i class="fas fa-moon"></i> Mode d'affichage</h3>
          <div class="option-group">
            <div class="option-item active" data-theme="dark" onclick="toggleTheme('dark')">
              <i class="fas fa-check"></i> Sombre
            </div>
            <div class="option-item" data-theme="light" onclick="toggleTheme('light')">
              Clair
            </div>
          </div>
        </div>

        <div class="settings-option">
          <h3><i class="fas fa-file-export"></i> Exportation</h3>
          <div class="button-group">
            <button onclick="downloadCSV()"><i class="fas fa-file-csv"></i> <span class="btn-text">Exporter CSV</span></button>
            <button onclick="downloadExcel()" class="secondary"><i class="fas fa-file-excel"></i> <span class="btn-text">Exporter Excel</span></button>
          </div>
        </div>
      </section>
    </div>
  </div>

  <script>
    // Variables globales
    let trades = [];
    let allTrades = [];
    let capitalChart, pieChart;
    let perfCapitalChart, perfPieChart, perfDailyChart;
    let currentSection = 'dashboard';
    let savedCapital = localStorage.getItem('tradingCapital') || 1000;
    let currentLanguage = localStorage.getItem('language') || 'fr';
    let currentTheme = localStorage.getItem('theme') || 'dark';

    // Conseils du jour
    const conseils = {
      fr: [
        "N'oublie pas : ton capital, c'est ton oxygène. Protège-le.",
        "Si tu n'es pas sûr, ne trade pas. L'inaction est parfois la meilleure décision.",
        "3 pertes d'affilée ? Pause. Reviens l'esprit clair.",
        "Tu veux être bon aujourd'hui, pas parfait.",
        "Note ton ressenti avant chaque trade, tu verras les patterns émotionnels.",
        "La patience paie. Ne cours pas après le marché.",
        "Le journal est ton miroir : il révèle la vérité."
      ],
      en: [
        "Remember: your capital is your oxygen. Protect it.",
        "If you're not sure, don't trade. Inaction is sometimes the best decision.",
        "3 losses in a row? Take a break. Come back with a clear mind.",
        "You want to be good today, not perfect.",
        "Write down your feelings before each trade, you'll see emotional patterns.",
        "Patience pays. Don't chase the market.",
        "The journal is your mirror: it reveals the truth."
      ]
    };

    // Initialisation des graphiques
    function initCharts() {
      // Graphique d'évolution du capital (vertical)
      const capitalCtx = document.getElementById('capitalChart').getContext('2d');
      capitalChart = new Chart(capitalCtx, {
        type: 'bar',
        data: { 
          labels: ['Jan', 'Fév', 'Mar', 'Avr', 'Mai', 'Jun', 'Jul', 'Aoû', 'Sep', 'Oct', 'Nov', 'Déc'],
          datasets: [{
            label: 'Capital',
            data: Array(12).fill(0),
            backgroundColor: '#4361ee',
            borderColor: '#4361ee',
            borderWidth: 1
          }]
        },
        options: {
          indexAxis: 'y',
          responsive: true,
          plugins: {
            title: {
              display: true,
              text: 'EVOLUTION DU CAPITAL',
              font: { size: 16 }
            },
            legend: { display: false }
          },
          scales: {
            x: { 
              beginAtZero: true,
              title: {
                display: true,
                text: 'Capital ($)'
              }
            },
            y: {
              title: {
                display: true,
                text: 'Mois'
              }
            }
          }
        }
      });
      
      // Graphique de performance des trades
      const pieCtx = document.getElementById('pieChart').getContext('2d');
      pieChart = new Chart(pieCtx, {
        type: 'doughnut',
        data: { 
          labels: ['Gagnants', 'Perdants'], 
          datasets: [{
            data: [0, 0],
            backgroundColor: ['#4ade80', '#f87171'],
            borderColor: ['rgba(255,255,255,0.8)', 'rgba(255,255,255,0.8)'],
            borderWidth: 1
          }]
        },
        options: {
          responsive: true,
          plugins: {
            title: {
              display: true,
              text: 'PERFORMANCE DES TRADES',
              font: { size: 16 }
            },
            legend: { position: 'bottom' }
          },
          cutout: '70%',
          maintainAspectRatio: false
        }
      });

      // Graphiques pour la section Performance
      const perfCapitalCtx = document.getElementById('perf-capitalChart').getContext('2d');
      perfCapitalChart = new Chart(perfCapitalCtx, {
        type: 'line',
        data: { labels: [], datasets: [] },
        options: {
          responsive: true,
          plugins: {
            title: {
              display: true,
              text: 'ÉVOLUTION DU CAPITAL',
              font: { size: 16 }
            },
            legend: { display: false }
          },
          elements: {
            line: {
              borderColor: '#4ade80',
              backgroundColor: 'rgba(74, 222, 128, 0.1)',
              tension: 0.1,
              fill: true
            },
            point: {
              radius: 5,
              hoverRadius: 7
            }
          },
          scales: {
            y: { beginAtZero: false }
          }
        }
      });
      
      const perfPieCtx = document.getElementById('perf-pieChart').getContext('2d');
      perfPieChart = new Chart(perfPieCtx, {
        type: 'doughnut',
        data: { 
          labels: ['Gagnants', 'Perdants'], 
          datasets: [] 
        },
        options: {
          responsive: true,
          plugins: {
            title: {
              display: true,
              text: 'PERFORMANCE DES TRADES',
              font: { size: 16 }
            },
            legend: { position: 'bottom' }
          },
          cutout: '70%',
          maintainAspectRatio: false
        }
      });
      
      const perfDailyCtx = document.getElementById('perf-dailyChart').getContext('2d');
      perfDailyChart = new Chart(perfDailyCtx, {
        type: 'bar',
        data: { labels: [], datasets: [] },
        options: {
          responsive: true,
          plugins: {
            title: {
              display: true,
              text: 'PERFORMANCE JOURNALIÈRE',
              font: { size: 16 }
            },
            legend: { display: false }
          },
          scales: {
            y: { beginAtZero: false }
          }
        }
      });
    }

    // Sauvegarde automatique des données
    function saveData() {
      localStorage.setItem('tradingJournal', JSON.stringify(allTrades));
      localStorage.setItem('tradingCapital', document.getElementById("initialCapital").value);
    }

    // Chargement des données sauvegardées
    function loadSavedData() {
      const savedData = localStorage.getItem('tradingJournal');
      const savedCapital = localStorage.getItem('tradingCapital');
      
      if (savedCapital) {
        document.getElementById("initialCapital").value = savedCapital;
      }
      
      if (savedData) {
        try {
          const data = JSON.parse(savedData);
          const tbody = document.querySelector("#tradeTable tbody");
          tbody.innerHTML = "";
          
          data.forEach(item => {
            addTrade(item);
          });
          
          updateStats();
        } catch (error) {
          console.error("Erreur lors du chargement des données:", error);
        }
      }
    }

    // Fonction pour basculer entre les sections
    function showSection(sectionId) {
      document.querySelectorAll('.section').forEach(section => {
        section.classList.remove('active');
      });
      
      document.getElementById(sectionId + '-section').classList.add('active');
      
      document.querySelectorAll('.nav-menu a, .dropdown-menu a').forEach(link => {
        link.classList.remove('active');
        if (link.getAttribute('data-section') === sectionId) {
          link.classList.add('active');
        }
      });
      
      currentSection = sectionId;
      
      if (sectionId === 'performance') {
        updatePerformanceCharts();
      }
      
      if (sectionId === 'dashboard') {
        animateTitle();
      }
    }

    // Animation du titre
    function animateTitle() {
      const title = document.getElementById('animated-title');
      title.style.animation = 'none';
      void title.offsetWidth;
      title.style.animation = 'fadeInScale 1s ease-in-out';
    }

    // Menu mobile
    function toggleMenu() {
      const dropdown = document.getElementById("dropdownMenu");
      dropdown.classList.toggle("show");
    }

    // Ajout d'un trade
    function addTrade(tradeData = null) {
      let table = document.querySelector("#tradeTable tbody");
      const row = document.createElement("tr");

      const fields = [
        { type: "date" },
        { type: "text", placeholder: "EURUSD" },
        { type: "number", placeholder: "0.01", step: "0.01" },
        { type: "select", options: ["Buy", "Sell"] },
        { type: "number", placeholder: "1.1200", step: "0.0001" },
        { type: "number", placeholder: "1.1250", step: "0.0001" },
        { type: "select", options: ["WIN", "LOSS"] },
        { type: "number", placeholder: "50" },
        { type: "text", placeholder: "1.5" }
      ];

      fields.forEach((field, i) => {
        const td = document.createElement("td");
        if (i === 1) td.classList.add("symbol-cell");
        
        let input;
        if (field.type === "select") {
          input = document.createElement("select");
          field.options.forEach(opt => {
            const option = document.createElement("option");
            option.value = opt;
            option.textContent = opt;
            input.appendChild(option);
          });
        } else {
          input = document.createElement("input");
          input.type = field.type;
          if (field.placeholder) input.placeholder = field.placeholder;
          if (field.step) input.step = field.step;
        }
        
        if (tradeData) {
          const fieldNames = ["date", "symbole", "lot", "direction", "entry", "exit", "result", "gain", "rrr"];
          if (fieldNames[i]) {
            if (field.type === "select") {
              input.value = tradeData[fieldNames[i]];
            } else {
              input.value = tradeData[fieldNames[i]];
            }
          }
        }
        
        td.appendChild(input);
        row.appendChild(td);
      });

      // Cellule Notes
      const notesCell = document.createElement("td");
      const notesInput = document.createElement("textarea");
      notesInput.placeholder = "Sentiment/Note...";
      notesInput.style.width = "100%";
      notesInput.style.minHeight = "50px";
      
      if (tradeData && tradeData.notes) {
        notesInput.value = tradeData.notes;
      }
      
      notesCell.appendChild(notesInput);
      row.appendChild(notesCell);

      // Configuration des événements
      const entryInput = row.querySelectorAll("td")[4].querySelector("input");
      const exitInput = row.querySelectorAll("td")[5].querySelector("input");
      const directionSelect = row.querySelectorAll("td")[3].querySelector("select");
      const resultSelect = row.querySelectorAll("td")[6].querySelector("select");
      const gainInput = row.querySelectorAll("td")[7].querySelector("input");
      const rrInput = row.querySelectorAll("td")[8].querySelector("input");

      const calculateRR = () => {
        const entry = parseFloat(entryInput.value);
        const exit = parseFloat(exitInput.value);
        const direction = directionSelect.value;
        
        if (!isNaN(entry) && !isNaN(exit)) {
          const rr = direction === "Buy" 
            ? ((exit - entry) / entry * 100).toFixed(2)
            : ((entry - exit) / entry * 100).toFixed(2);
          rrInput.value = rr;
        }
      };

      const formatGain = () => {
        const value = parseFloat(gainInput.value) || 0;
        const isWin = resultSelect.value === "WIN";
        
        gainInput.style.backgroundColor = isWin ? "rgba(74, 222, 128, 0.2)" : "rgba(248, 113, 113, 0.2)";
        gainInput.style.color = isWin ? "var(--win-color)" : "var(--loss-color)";
        gainInput.style.fontWeight = "bold";
        gainInput.style.borderRadius = "9999px";
        gainInput.style.textAlign = "center";
      };

      const updateGain = () => {
        const currentValue = parseFloat(gainInput.value) || 0;
        gainInput.value = resultSelect.value === "WIN" 
          ? Math.abs(currentValue) 
          : -Math.abs(currentValue);
        formatGain();
      };

      // Ajout des écouteurs d'événements
      entryInput.addEventListener('input', () => {
        calculateRR();
        updateStats();
        saveData();
      });
      
      exitInput.addEventListener('input', () => {
        calculateRR();
        updateStats();
        saveData();
      });
      
      directionSelect.addEventListener('change', () => {
        calculateRR();
        updateStats();
        saveData();
      });
      
      resultSelect.addEventListener('change', () => {
        updateGain();
        updateStats();
        saveData();
      });
      
      gainInput.addEventListener('input', () => {
        formatGain();
        updateStats();
        saveData();
      });
      
      notesCell.querySelector("textarea").addEventListener('input', saveData);

      // Calcul initial si des données sont fournies
      if (tradeData) {
        calculateRR();
        formatGain();
      }

      table.appendChild(row);
      return row;
    }

    // Mise à jour des statistiques
    function updateStats() {
      const rows = document.querySelectorAll("#tradeTable tbody tr");
      trades = [];
      let totalGain = 0;
      let wins = 0;
      let totalRRR = 0;
      let totalProfit = 0;
      let totalLoss = 0;
      const initialCapital = parseFloat(document.getElementById("initialCapital").value) || 1000;

      rows.forEach(row => {
        const cells = row.querySelectorAll("td");
        if (cells.length >= 10) {
          const date = cells[0].querySelector("input").value;
          const symbole = cells[1].querySelector("input").value;
          const lot = cells[2].querySelector("input").value;
          const direction = cells[3].querySelector("select").value;
          const entry = cells[4].querySelector("input").value;
          const exit = cells[5].querySelector("input").value;
          const result = cells[6].querySelector("select").value;
          const gain = parseFloat(cells[7].querySelector("input").value) || 0;
          const rrr = parseFloat(cells[8].querySelector("input").value) || 0;
          const notes = cells[9].querySelector("textarea")?.value || "";

          const trade = {
            date, symbole, lot, direction, entry, exit, result, gain, rrr, notes
          };

          trades.push(trade);

          totalGain += gain;
          totalRRR += rrr;
          if (result === "WIN") {
            wins++;
            totalProfit += gain;
          } else {
            totalLoss += Math.abs(gain);
          }
        }
      });

      allTrades = [...trades];
      
      // Calcul du drawdown
      let maxCapital = initialCapital;
      let maxDrawdown = 0;
      let currentCapital = initialCapital;
      
      trades.forEach(trade => {
        currentCapital += trade.gain;
        if (currentCapital > maxCapital) {
          maxCapital = currentCapital;
        }
        const drawdown = ((maxCapital - currentCapital) / maxCapital) * 100;
        if (drawdown > maxDrawdown) {
          maxDrawdown = drawdown;
        }
      });

      // Calcul des performances mensuelles
      const monthlyData = {};
      trades.forEach(trade => {
        const date = new Date(trade.date);
        const month = date.getMonth();
        const year = date.getFullYear();
        
        if (year === 2024) {
          if (!monthlyData[month]) {
            monthlyData[month] = { profit: 0, rr: 0, count: 0 };
          }
          monthlyData[month].profit += trade.gain;
          monthlyData[month].rr += trade.rrr;
          monthlyData[month].count++;
        }
      });

      // Mise à jour des statistiques
      const avgRRR = trades.length ? totalRRR / trades.length : 0;
      const winRate = trades.length ? (wins / trades.length) * 100 : 0;
      const profitFactor = totalLoss > 0 ? totalProfit / totalLoss : totalProfit > 0 ? Infinity : 0;

      document.getElementById("totalGain").textContent = `${((totalGain / initialCapital) * 100).toFixed(1)}%`;
      document.getElementById("averageRRR").textContent = avgRRR.toFixed(2);
      document.getElementById("profitFactor").textContent = profitFactor === Infinity ? "∞" : profitFactor.toFixed(2);
      document.getElementById("winRate").textContent = `${winRate.toFixed(1)}%`;
      document.getElementById("drawdown").textContent = `${maxDrawdown.toFixed(2)}%`;

      // Mise à jour du tableau mensuel
      const months = ['jan', 'feb', 'mar', 'apr', 'may', 'jun', 'jul', 'aug', 'sep', 'oct', 'nov', 'dec'];
      months.forEach((month, index) => {
        const monthData = monthlyData[index] || { profit: 0, rr: 0, count: 1 };
        document.getElementById(`${month}-profit`).textContent = 
          `${((monthData.profit / initialCapital) * 100).toFixed(2)}%`;
        document.getElementById(`${month}-rr`).textContent = 
          monthData.count > 0 ? (monthData.rr / monthData.count).toFixed(2) : '0';
      });

      // Calcul du total annuel
      const totalYearProfit = Object.values(monthlyData).reduce((sum, month) => sum + month.profit, 0);
      const totalYearRR = Object.values(monthlyData).reduce((sum, month) => sum + month.rr, 0);
      const totalYearCount = Object.values(monthlyData).reduce((sum, month) => sum + month.count, 0);
      
      document.getElementById("year-profit").textContent = 
        `${((totalYearProfit / initialCapital) * 100).toFixed(2)}%`;
      document.getElementById("year-rr").textContent = 
        totalYearCount > 0 ? (totalYearRR / totalYearCount).toFixed(2) : '0';

      // Mise à jour des graphiques
      updateCharts();
    }

    // Mise à jour des graphiques
    function updateCharts() {
      updateCapitalChart();
      updatePieChart();
    }

    function updateCapitalChart() {
      const initialCapital = parseFloat(document.getElementById("initialCapital").value) || 1000;
      const monthlyData = Array(12).fill(initialCapital);
      
      trades.forEach(trade => {
        const date = new Date(trade.date);
        const month = date.getMonth();
        if (date.getFullYear() === 2024) {
          monthlyData[month] += trade.gain;
        }
      });

      capitalChart.data.datasets[0].data = monthlyData;
      capitalChart.update();
    }

    function updatePieChart() {
      const wins = trades.filter(t => t.result === "WIN").length;
      const losses = trades.length - wins;
      
      pieChart.data.datasets = [{
        data: [wins, losses],
        backgroundColor: ['#4ade80', '#f87171'],
        borderColor: ['rgba(255,255,255,0.8)', 'rgba(255,255,255,0.8)'],
        borderWidth: 1
      }];
      
      pieChart.update();
    }

    // Mise à jour des graphiques de performance
    function updatePerformanceCharts() {
      const initialCapital = parseFloat(document.getElementById('initialCapital').value) || 0;
      let capitalData = [initialCapital];
      const labels = ['Initial'];
      
      trades.forEach((trade, i) => {
        capitalData.push(capitalData[i] + trade.gain);
        labels.push(`Trade ${i+1}`);
      });

      // Graphique d'évolution du capital
      perfCapitalChart.data.labels = labels;
      perfCapitalChart.data.datasets = [{
        label: 'Capital ($)',
        data: capitalData,
        borderColor: '#4ade80',
        backgroundColor: 'rgba(74, 222, 128, 0.1)',
        tension: 0.1,
        fill: true,
        pointBackgroundColor: capitalData.map((val, i) => i === 0 ? 'gray' : val > capitalData[i-1] ? '#4ade80' : '#f87171'),
        pointRadius: capitalData.map((val, i) => i === 0 ? 3 : 5)
      }];
      
      perfCapitalChart.update();

      // Graphique de performance des trades
      const wins = trades.filter(t => t.result === "WIN").length;
      const losses = trades.length - wins;
      
      perfPieChart.data.datasets = [{
        data: [wins, losses],
        backgroundColor: ['#4ade80', '#f87171'],
        borderColor: ['rgba(255,255,255,0.8)', 'rgba(255,255,255,0.8)'],
        borderWidth: 1
      }];
      
      perfPieChart.update();

      // Graphique de performance journalière
      const dailyData = {};
      trades.forEach(trade => {
        if (!dailyData[trade.date]) {
          dailyData[trade.date] = 0;
        }
        dailyData[trade.date] += trade.gain;
      });
      
      const dates = Object.keys(dailyData).sort();
      const gains = dates.map(date => dailyData[date]);
      
      perfDailyChart.data.labels = dates;
      perfDailyChart.data.datasets = [{
        label: 'Daily P/L ($)',
        data: gains,
        backgroundColor: gains.map(g => g >= 0 ? '#4ade80' : '#f87171'),
        borderColor: gains.map(g => g >= 0 ? 'rgba(74, 222, 128, 0.8)' : 'rgba(248, 113, 113, 0.8)'),
        borderWidth: 1
      }];
      
      perfDailyChart.update();
    }

    // Application des filtres
    function applyFilters() {
      const symbolFilter = document.getElementById("symbolFilter").value.toLowerCase();
      const dateFrom = document.getElementById("dateFromFilter").value;
      const dateTo = document.getElementById("dateToFilter").value;

      trades = allTrades.filter(trade => {
        const symbolMatch = !symbolFilter || trade.symbole.toLowerCase().includes(symbolFilter);
        const dateFromMatch = !dateFrom || trade.date >= dateFrom;
        const dateToMatch = !dateTo || trade.date <= dateTo;
        return symbolMatch && dateFromMatch && dateToMatch;
      });

      updateStats();
    }

    // Réinitialisation des filtres
    function resetFilters() {
      document.getElementById("symbolFilter").value = "";
      document.getElementById("dateFromFilter").value = "";
      document.getElementById("dateToFilter").value = "";
      applyFilters();
    }

    // Export en JSON
    function downloadJSON() {
      const data = JSON.stringify(allTrades, null, 2);
      const blob = new Blob([data], { type: "application/json" });
      const link = document.createElement("a");
      link.href = URL.createObjectURL(blob);
      link.download = `trading_journal_${new Date().toISOString().split('T')[0]}.json`;
      link.click();
    }

    // Export en CSV
    function downloadCSV() {
      const headers = ["Date", "Symbol", "Lot", "Direction", "Entry", "Exit", "Result", "P/L", "RR", "Notes"];
      const csvRows = [
        headers.join(","),
        ...allTrades.map(trade => 
          headers.map(header => {
            const key = header.toLowerCase().replace('/', '').replace(' ', '');
            const value = trade[key] || "";
            return `"${value.toString().replace(/"/g, '""')}"`;
          }).join(",")
        )
      ];
      
      const csv = csvRows.join("\n");
      const blob = new Blob([csv], { type: "text/csv" });
      const link = document.createElement("a");
      link.href = URL.createObjectURL(blob);
      link.download = `trading_journal_${new Date().toISOString().split('T')[0]}.csv`;
      link.click();
    }

    // Export en Excel
    function downloadExcel() {
      downloadCSV();
    }

    // Chargement de fichier
    document.getElementById("fileInput").addEventListener("change", function(e) {
      const file = e.target.files[0];
      if (!file) return;
      const reader = new FileReader();
      reader.onload = function(event) {
        try {
          const data = JSON.parse(event.target.result);
          const tbody = document.querySelector("#tradeTable tbody");
          tbody.innerHTML = "";
          
          data.forEach(item => {
            addTrade(item);
          });
          
          updateStats();
          saveData();
        } catch (error) {
          alert("Erreur lors du chargement du fichier: " + error.message);
        }
      };
      reader.readAsText(file);
    });

    // Affichage du conseil du jour
    function showDailyTip() {
      const randomTip = conseils[currentLanguage][Math.floor(Math.random() * conseils[currentLanguage].length)];
      document.getElementById("conseilDuJour").innerHTML = `
        <i class="fas fa-lightbulb"></i> ${randomTip}
      `;
    }

    // Changement de langue
    function changeLanguage(lang) {
      currentLanguage = lang;
      localStorage.setItem('language', lang);
      
      document.querySelectorAll('.option-item[data-lang]').forEach(item => {
        item.classList.remove('active');
        if (item.getAttribute('data-lang') === lang) {
          item.classList.add('active');
          item.innerHTML = `<i class="fas fa-check"></i> ${item.textContent}`;
        } else {
          item.innerHTML = item.textContent;
        }
      });
      
      showDailyTip();
    }

    // Changement de thème
    function toggleTheme(theme) {
      currentTheme = theme;
      localStorage.setItem('theme', theme);
      
      if (theme === 'light') {
        document.body.classList.add('light-mode');
      } else {
        document.body.classList.remove('light-mode');
      }
      
      document.querySelectorAll('.option-item[data-theme]').forEach(item => {
        item.classList.remove('active');
        if (item.getAttribute('data-theme') === theme) {
          item.classList.add('active');
          item.innerHTML = `<i class="fas fa-check"></i> ${item.textContent}`;
        } else {
          item.innerHTML = item.textContent;
        }
      });
    }

    // Initialisation
    document.addEventListener('DOMContentLoaded', () => {
      // Appliquer le thème sauvegardé
      if (currentTheme === 'light') {
        document.body.classList.add('light-mode');
      }
      
      // Appliquer la langue sauvegardée
      changeLanguage(currentLanguage);
      
      // Splash screen
      const splash = document.getElementById('splash');
      const btn = document.getElementById('enterBtn');
      const app = document.getElementById('mainApp');

      setTimeout(() => btn.classList.add('show'), 1000);

      btn.addEventListener('click', () => {
        splash.style.display = 'none';
        app.style.display = 'block';
        
        // Initialiser les graphiques
        initCharts();
        
        // Charger les données sauvegardées
        loadSavedData();
        
        // Si aucune donnée sauvegardée, ajouter 3 trades d'exemple
        if (allTrades.length === 0) {
          for (let i = 0; i < 3; i++) addTrade();
        }
        
        // Mettre à jour les statistiques initiales
        updateStats();
        
        // Afficher le conseil du jour
        showDailyTip();
        
        // Configurer les écouteurs d'événements pour la navigation
        document.querySelectorAll('.nav-menu a, .dropdown-menu a').forEach(link => {
          link.addEventListener('click', function(e) {
            e.preventDefault();
            const section = this.getAttribute('data-section');
            if (section) {
              showSection(section);
            }
            
            // Fermer le menu déroulant si ouvert
            document.getElementById('dropdownMenu').classList.remove('show');
          });
        });
        
        // Sauvegarder automatiquement quand le capital change
        document.getElementById("initialCapital").addEventListener('change', function() {
          saveData();
          updateStats();
        });
      });
    });
  </script>
</body>
</html>